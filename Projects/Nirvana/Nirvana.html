<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Portfolio â€¢ Nirvana</title>

        <link rel="stylesheet" href="../../style.css">
        <link rel="shortcut icon" href="../../favicon.ico">

        <link rel="stylesheet" href="../project.css">
        <link rel="stylesheet" href="./style.css">
    </head>

    <body>
        <div class="main">
            <div class="title">
                Enemy Behavior
            </div>

            <div class="section">
                <div class="text">
                    Here, I will present the main lines of the enemy behavior in Nirvana, my graduation game.<br>
                    <br>
                    The goal is to make the enemies' behavior feel natural.
                    Each of them has to give the impression to be unique, without hindering each other.
                    <br>
                    And most importantly, since it is a bullet-hell, the enemy positions and the bullet patterns are crucial.
                    We don't want the player to be overwhelmed or unaffected.
                </div>
            </div>

            <div class="section">
                <div class="text">
                    <div class="subtitle">Solution:</div><br>

                    The main idea is to manage 3 "zones" around the player.<br>
                    I will name them:<br>
                    &nbsp;&nbsp;&nbsp;&nbsp; - front row<br>
                    &nbsp;&nbsp;&nbsp;&nbsp; - middle row<br>
                    &nbsp;&nbsp;&nbsp;&nbsp; - back row<br>
                    <br>
                    This will help to:<br>
                    &nbsp;&nbsp;&nbsp;&nbsp; - Spread the enemies evenly around the player<br>
                    &nbsp;&nbsp;&nbsp;&nbsp; - Calculate the bullet-hell shoots-sequences<br>

                    <div class="image">
                        <img src="scheme-zones.png">
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="text">
                    <div class="subtitle">Sorting the Enemies</div><br>

                    <div class="section">
                        I use a <a href="https://en.wikipedia.org/wiki/Quicksort">simple partition quicksort</a> 
                        to sort the enemies according to their distance from the player.<br>
                        This function is very sufficient for its purpose.<br>
                        Here is how I implemented it on blueprint:

                        <div class="image">
                            <img src="quicksort_main.png">
                            <img src="quicksort_partition.png">
                        </div>
                    </div>
                    
                    <div class="section">
                        And now comes the idea of the 3 "zones".<br>
                        Once the enemies are sorted, they are dispatched on a zone by modifying their range.
                        Because their movements are based on their range, they will be placed naturally.<br>
                        <br>
                        Their references are also saved in an array for the corresponding zone.<br>
                        This is these 3 arrays that provide the control over the enemies.

                        <div class="image">
                            <img src="range-assignement.png">
                        </div>

                        The range values depend on the corresponding battle-arena 
                        (which is the class that manages the coordination algorithms). 
                        This is useful to adapt the zones' sizes, depending on the battle environment (small, big, narrow, circular, etc...).<br>
                        I chose this class to inherit from Actor, because it made it easier for the level-designers to manage each area differently.
                        However, this could have been a game-subsystem or something else depending on how we want to manage the battle system.
                    </div>
                    <br>
                    <div class="section">
                        With this sorting, the enemies will stand at an average predetermined distance from the player in real-time;<br>
                        Meaning that even if the player moves, the enemies will adapt their position.
                        <div class="image">
                            <img src="video.mp4">
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <div class="subtitle">Shoots Calculation</div><br>
                <div class="section">
                    <div class="text">
                        Now that we have control the enemies and their positional behavior, 
                        it is way much easier to control their shoots.<br>
                        <br>
                        For example I can launch a shoot sequance such as:<br>
                        &nbsp;&nbsp;&nbsp;&nbsp; - back row (wait 0.2s)<br>
                        &nbsp;&nbsp;&nbsp;&nbsp; - middle row (wait 0.2s)<br>
                        &nbsp;&nbsp;&nbsp;&nbsp; - front row<br>

                        <div class="image">
                            <img src="token-distribution.png">
                        </div>

                        I set up a simple token system for the shoot sequences so as not to disrupt the enemies' current behavior.
                        They shoot when they can.<br>
                        A shoot sequence launching is actually a token distribution. Once 
                        all the tokens are retreived (plus other optional parameters), another distribution is called.
                    </div>
                </div>
                <div class="section">
                    <div class="text">
                        To select the current shooter of a zone, it is very simple.
                        I have a stack  of references for each enemy. That way, once an enemy gets 
                        a token, it is pushed-back to the bottom of the "queue".
                        <div class="image">
                            <img src="get-shooter.png">
                        </div>

                        Each enemy type has different patterns, and they shoot the corresponding pattern according to their current position.
                        <br>
                        <br>
                        I also prioritize the low health enemies because they are more likely to
                        be the current player's target<br>
                        For clarity, this is not included in the above blueprint. 
                        There are other details like this that I didn't mentionned for the same reason.
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="text">
                    <div class="subtitle">Conclusion</div>
                    
                </div>
            </div>
            <div class="footer">
                <a class="left" href="../../projects.html">HOME</a>
                <a class="pic" href="https://github.com/nathangateaureuze"><img src="../../icons/github-white.png"></a>
                <a class="pic" href="https://linkedin.com/in/nathan-gateau-reuze"><img src="../../icons/linkedin.png"></a>
            </div>
        </div>
    </body>
</html>